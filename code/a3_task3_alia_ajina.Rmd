---
title: "Assignment 3 Task 3: Santa Barbara Urchins "
author: "Alia Ajina"
date: "10/28/2021"
output: html_document
---

## Overview
This code uses version control, project management, data wrangling, analysis, and visualization skills to explore red and purple urchin records from the Santa Barbara Coastal Long Term Ecological Research (SBC LTER) program's divers. The data is from a long-term experiment on kelp removal and the sea urchin (red and purple) size frequency distribution.

Data Citation: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

## Setup

Attach tidyverse, here, janitor, and kableExtra packages.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = TRUE, message = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
```

## Reach in Urchins data

```{r, Read in Data}
urchins <- read_csv(here("data", "urchins.csv"))
```

## Data Wrangling

Clean the data

```{r}
urchins_clean <- urchins %>% 
  clean_names()
```

## Data Visualization

Create a finalized, faceted histogram comparing the distribution of sizes between purple and red sea urchins.

```{r}
ggplot(data = urchins_clean, aes(x = size)) +
  geom_histogram(aes(fill = common_name, color = common_name), bins = 10) + 
  facet_wrap(~ common_name) + 
  scale_color_manual(values = c("white", "white")) +
  scale_fill_manual(values = c("#CBC3E3", "#801B1B")) +
  theme_gray() + 
  theme(axis.title.x = element_text(hjust = 0.5, vjust = 0.5),
        plot.title = element_text(hjust = .5), 
        plot.subtitle = element_text(hjust = .5),
        plot.caption = element_text(hjust = .3),
        legend.position = "none") +
  labs( x = "Urchin Diameter (cm)",
        y = "Number of Urchins",
        title = "Distribution of Sizes between Red and Purple Urchins (AJINA)",
        subtitle = "Santa Barbara Coastal Long Term Ecological Research", 
        caption = "Figure 1: Distribution of sizes between purple and red sea urchins at five different sites along the Santa Barbara Coast.")
```

## Summary Statistics

Summary table of statistics for purple and red urchins including mean, median, standard deviation, and sample size.

```{r}
urchins_summary <- urchins_clean %>% 
  group_by(common_name) %>% 
  summarize(mean = round(mean(size), 1), 
            sd = round(sd(size), 1),
            median = median(size),
            sample_size = n())

urchins_summary %>% 
  kable(col.names = c("Common Name", 
                      "Mean Size (cm)",
                      "Median Size (cm)",
                      "Standard Deviation (cm)",
                      "Sample Size"),
        caption = "<center> Table 1: Summary Statistics of Purple and Red Urchins<center>") %>% 
  kable_styling(bootstrap_options = "bordered",
                full_width = F, position = "center")


```

